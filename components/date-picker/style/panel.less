@import './index';

@picker-cell-inner-cls: ~'@{picker-prefix-cls}-cell-inner';
@picker-legacy-cell-cls: ~'@{ant-prefix}-calendar-date';

.@{picker-prefix-cls} {
  @picker-basic-cell-hover-color: fade(@primary-color, 10%);
  @picker-border: @border-width-base @border-style-base @border-color-split;
  @picker-arrow-size: 7px;
  @picker-date-hover-range-border: @border-width-base dashed fade(@primary-color, 50%);
  @picker-panel-width: 280px;
  @picker-year-month-cell-width: 60px;

  &-panel {
    display: inline-block;
    text-align: center;
    background: @calendar-bg;
    border: @picker-border;
    border-radius: @border-radius-base;
    outline: none;

    &-focused {
      border-color: @primary-color;
    }
  }

  // ========================================================
  // =                     Shared Panel                     =
  // ========================================================
  &-decade-panel,
  &-year-panel,
  &-month-panel,
  &-week-panel,
  &-date-panel,
  &-time-panel {
    display: flex;
    flex-direction: column;
    width: @picker-panel-width;
  }

  // ======================= Header =======================
  &-header {
    display: flex;
    padding: 0 @padding-xs;
    color: @heading-color;
    border-bottom: @picker-border;

    > * {
      flex: none;
    }

    button {
      padding: 0;
      color: @disabled-color;
      line-height: @picker-text-height;
      background: transparent;
      border: 0;
      cursor: pointer;
      transition: color 0.3s;
    }

    > button {
      min-width: 1.6em;
      font-size: @font-size-base;

      &:hover {
        color: @text-color;
      }
    }

    &-view {
      flex: auto;
      font-weight: 500;
      line-height: @picker-text-height;

      button {
        color: inherit;
        font-weight: inherit;

        &:not(:first-child) {
          margin-left: @padding-xs;
        }

        &:hover {
          color: @primary-color;
        }
      }
    }
  }

  // Arrow button
  &-prev-icon,
  &-next-icon,
  &-super-prev-icon,
  &-super-next-icon {
    position: relative;
    display: inline-block;
    width: @picker-arrow-size;
    height: @picker-arrow-size;

    &::before {
      position: absolute;
      top: 0;
      left: 0;
      display: inline-block;
      width: @picker-arrow-size;
      height: @picker-arrow-size;
      border: 0 solid currentColor;
      border-width: 1.5px 0 0 1.5px;
      content: '';
    }
  }

  &-super-prev-icon,
  &-super-next-icon {
    &::after {
      position: absolute;
      top: ceil(@picker-arrow-size / 2);
      left: ceil(@picker-arrow-size / 2);
      display: inline-block;
      width: @picker-arrow-size;
      height: @picker-arrow-size;
      border: 0 solid currentColor;
      border-width: 1.5px 0 0 1.5px;
      content: '';
    }
  }

  &-prev-icon,
  &-super-prev-icon {
    transform: rotate(-45deg);
  }

  &-next-icon,
  &-super-next-icon {
    transform: rotate(135deg);
  }

  // ======================== Body ========================
  &-content {
    width: 100%;
    table-layout: fixed;
    border-collapse: collapse;

    th,
    td {
      position: relative;
      min-width: 24px;
      font-weight: 400;
    }

    th {
      height: 30px;
      color: @text-color;
      line-height: 30px;
    }
  }

  .picker-cell-inner(@cellClassName) {
    &::before {
      position: absolute;
      top: 50%;
      right: 0;
      left: 0;
      height: 24px;
      transform: translateY(-50%);
      transition: background 0.3s;
      content: '';
    }

    // Default
    .@{cellClassName} {
      position: relative;
      z-index: 1;
      display: inline-block;
      min-width: 24px;
      height: 24px;
      line-height: 24px - @border-width-base * 2;
      border: @border-width-base @border-style-base transparent;
      border-radius: @border-radius-base;
      transition: background 0.3s, border 0.3s;
    }

    &:hover .@{cellClassName} {
      background: @picker-basic-cell-hover-color;
    }

    // Today
    &-in-view&-today .@{cellClassName} {
      border-color: @primary-color;
    }

    // In range
    &-in-view&-in-range {
      position: relative;

      &::before {
        background: @picker-basic-cell-hover-color;
      }
    }

    // Selected
    &-in-view&-selected .@{cellClassName},
    &-in-view&-selected:hover .@{cellClassName},
    &-in-view&-range-start .@{cellClassName},
    &-in-view&-range-start:hover .@{cellClassName},
    &-in-view&-range-end .@{cellClassName},
    &-in-view&-range-end:hover .@{cellClassName} {
      color: @text-color-inverse;
      background: @primary-color;
    }

    // Hover
    &-in-view&-range-hover-start:not(&-in-range):not(&-range-start):not(&-range-end),
    &-in-view&-range-hover-end:not(&-in-range):not(&-range-start):not(&-range-end),
    &-in-view&-range-hover:not(&-in-range):not(&-range-start):not(&-range-end) {
      &::after {
        content: '';
        position: absolute;
        top: 50%;
        height: 24px;
        transform: translateY(-50%);
        z-index: 1;
        border-top: @picker-date-hover-range-border;
        border-bottom: @picker-date-hover-range-border;
      }
    }

    &-range-hover-start::after,
    &-range-hover-end::after,
    &-range-hover::after {
      right: 0;
      left: 2px;
    }
    tr > &-in-view&-range-hover:first-child::after,
    tr > &-in-view&-range-hover-end:first-child::after,
    &-range-hover-edge-start::after,
    &-range-hover-start::after {
      border-left: @picker-date-hover-range-border;
      border-top-left-radius: @border-radius-base;
      border-bottom-left-radius: @border-radius-base;
      left: 6px;
    }
    tr > &-in-view&-range-hover:last-child::after,
    tr > &-in-view&-range-hover-start:last-child::after,
    &-range-hover-edge-end::after,
    &-range-hover-end::after {
      border-right: @picker-date-hover-range-border;
      border-top-right-radius: @border-radius-base;
      border-bottom-right-radius: @border-radius-base;
      right: 6px;
    }

    // Disabled
    &-disabled,
    &-disabled:hover {
      .@{cellClassName} {
        color: @disabled-color;
        background: transparent;
      }

      &::before {
        background: @disabled-bg;
      }
    }
  }

  &-cell {
    padding: 3px 0;
    color: @disabled-color;
    cursor: pointer;

    // In view
    &-in-view {
      color: @text-color;
    }

    // Disabled
    &-disabled {
      cursor: not-allowed;
    }

    .picker-cell-inner(~'@{picker-cell-inner-cls}');
    .picker-cell-inner(~'@{picker-legacy-cell-cls}');
  }

  &-decade-panel,
  &-year-panel,
  &-month-panel {
    .@{picker-prefix-cls}-content {
      height: 265px;
    }

    .@{picker-cell-inner-cls} {
      padding: 0 @padding-xs;
    }

    .@{picker-prefix-cls}-cell {
      &-disabled .@{picker-cell-inner-cls} {
        background: @disabled-bg;
      }
    }
  }

  &-decade-panel {
    .@{picker-prefix-cls}-cell {
      &::before {
        display: none;
      }
    }
  }

  // ======================== Footer ========================
  &-footer {
    padding: 0 @padding-xs;
    line-height: @picker-text-height - 2 * @border-width-base;
    text-align: center;
    border-top: @picker-border;

    &-extra {
      line-height: @picker-text-height - 2 * @border-width-base;
      padding: 0 @padding-xs;
      text-align: left;
    }
  }

  &-now {
    text-align: left;
    padding: 0 @padding-xs;
  }

  &-today-btn {
    color: @link-color;

    &:hover {
      color: @link-hover-color;
    }

    &:active {
      color: @link-active-color;
    }
  }

  // ========================================================
  // =                       Special                        =
  // ========================================================

  // ===================== Decade Panel =====================
  &-decade-panel {
    .@{picker-cell-inner-cls} {
      padding: 0 (@padding-xs / 2);
    }
  }

  // ================== Year & Month Panel ==================
  &-year-panel,
  &-month-panel {
    @hover-cell-fixed-distance: (
        (@picker-panel-width - @padding-xs * 2) / 3 - @picker-year-month-cell-width
      ) / 2;

    .@{picker-prefix-cls}-body {
      padding: 0 @padding-xs;
    }

    .@{picker-cell-inner-cls} {
      width: @picker-year-month-cell-width;
    }

    .@{picker-prefix-cls}-cell-range-hover-start::after {
      border-left: @picker-date-hover-range-border;
      border-radius: @border-radius-base 0 0 @border-radius-base;
      left: @hover-cell-fixed-distance;
    }
    .@{picker-prefix-cls}-cell-range-hover-end::after {
      border-right: @picker-date-hover-range-border;
      border-radius: 0 @border-radius-base @border-radius-base 0;
      right: @hover-cell-fixed-distance;
    }
  }

  // ====================== Week Panel ======================
  &-week-panel {
    .@{picker-prefix-cls}-body {
      padding: @padding-xs @padding-sm;
    }

    // Clear cell style
    .@{picker-prefix-cls}-cell {
      &:hover .@{picker-cell-inner-cls},
      &-selected .@{picker-cell-inner-cls},
      .@{picker-cell-inner-cls} {
        background: transparent;
      }
    }

    &-row {
      td {
        transition: background 0.3s;
      }

      &:hover td {
        background: @picker-basic-cell-hover-color;
      }

      &-selected td,
      &-selected:hover td {
        background: @primary-color;

        &.@{picker-prefix-cls}-cell-week {
          color: fade(@text-color-inverse, 50%);
        }

        &.@{picker-prefix-cls}-cell-today .@{picker-cell-inner-cls} {
          border-color: @text-color-inverse;
        }

        .@{picker-cell-inner-cls} {
          color: @text-color-inverse;
        }
      }
    }
  }

  // ====================== Date Panel ======================
  &-date-panel {
    .@{picker-prefix-cls}-body {
      padding: @padding-xs @padding-sm;
    }

    .@{picker-prefix-cls}-content {
      th {
        width: 33px;
      }
    }
  }

  // ==================== Datetime Panel ====================
  &-datetime-panel {
    display: flex;

    .@{picker-prefix-cls}-time-panel {
      border-left: @picker-border;
    }

    .@{picker-prefix-cls}-date-panel,
    .@{picker-prefix-cls}-time-panel {
      transition: opacity 0.3s;
    }

    // Keyboard
    &-active {
      .@{picker-prefix-cls}-date-panel,
      .@{picker-prefix-cls}-time-panel {
        opacity: 0.3;

        &-active {
          opacity: 1;
        }
      }
    }
  }

  // ====================== Time Panel ======================
  &-time-panel {
    width: auto;
    min-width: auto;

    .@{picker-prefix-cls}-content {
      display: flex;
      flex: auto;
      height: 224px;
    }

    &-column {
      flex: none;
      width: 56px;
      margin: 0;
      padding: 0 0 194px 0;
      overflow-y: hidden;
      text-align: left;
      list-style: none;
      transition: background 0.3s;

      &:not(:first-child) {
        border-left: @picker-border;
      }

      &-active {
        background: rgba(0, 0, 255, 0.1);
      }

      &:hover {
        overflow-y: auto;
      }

      > li {
        margin: 0;
        padding: 0;

        &.@{picker-prefix-cls}-time-panel-cell {
          .@{picker-prefix-cls}-time-panel-cell-inner {
            cursor: pointer;
            display: block;
            width: 100%;
            height: 32px;
            margin: 0;
            padding: 0;
            color: @text-color;
            line-height: 32px;
            text-align: center;
            border-radius: 0;

            &:hover {
              background: @item-hover-bg;
            }
          }

          &-selected {
            .@{picker-prefix-cls}-time-panel-cell-inner {
              background: @calendar-item-active-bg;
            }
          }

          &-disabled {
            .@{picker-prefix-cls}-time-panel-cell-inner {
              cursor: not-allowed;
              color: @disabled-color;
              background: transparent;
            }
          }
        }
      }
    }
  }
}
